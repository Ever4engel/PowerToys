<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

  <?include $(sys.CURRENTDIR)\Common.wxi?>

  <Fragment>
    <DirectoryRef Id="CmdNotFoundInstallFolder" FileSource="$(var.BinDir)modules\$(var.CmdNotFoundProjectName)">
      <!-- !Warning! Make sure to change Component Guid if you update the file list -->
      <Component Id="Module_CmdNotFound" Win64="yes" Guid="80F648F2-29F6-4685-AED4-04DC1B6EE176">
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="Module_CmdNotFound" Value="" KeyPath="yes"/>
        </RegistryKey>
        <File Source="$(var.BinDir)modules\$(var.CmdNotFoundProjectName)\PowerToys.CmdNotFoundModuleInterface.dll" />
      </Component>
    </DirectoryRef>

    <ComponentGroup Id="CmdNotFoundComponentGroup">
      <Component Id="RemoveCmdNotFoundFolder" Guid="C32B0224-2965-4082-BC20-600AD93F872F" Directory="CmdNotFoundInstallFolder" >
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveCmdNotFoundFolder" Value="" KeyPath="yes"/>
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderCmdNotFoundInstallFolder" Directory="CmdNotFoundInstallFolder" On="uninstall"/>
      </Component>
      <ComponentRef Id="Module_CmdNotFound" />
    </ComponentGroup>

  </Fragment>
</Wix>
